"use strict";(self.webpackChunkapp_viagens=self.webpackChunkapp_viagens||[]).push([[687],{687:(qe,R,d)=>{d.r(R),d.d(R,{ReportsModule:()=>Ue});var y=d(6895),u=d(4006),_=d(3546),C=d(9549),F=d(4144),k=d(4385),Z=d(4859),A=d(7392),x=d(9602),I=d(3238),m=d(7155),N=d(1572),w=d(7009),M=d(3848),D=d(7957),b=d(7084),E=d(144),h=d(9646),U=d(8372),q=d(1884),J=d(3900),L=d(262),P=d(4004),V=d(8746);const B={air_ticket:"Passagem A\xe9rea",bus_ticket:"Passagem Rodovi\xe1ria",train_ticket:"Passagem Ferrovi\xe1ria",hotel:"Hotel",car_rental:"Aluguel de Ve\xedculo",travel_insurance:"Seguro Viagem",travel_package:"Pacote de Viagem",transfer:"Transfer",seat:"Assento",extra_baggage:"Bagagem Extra",rebooking:"Remarca\xe7\xe3o"};function p(r){if(null==r)return"";const s=String(r).trim();return s?B[s]??s:""}const j=[{key:"performance",label:"Desempenho",code:"A",description:"Indicadores e visoes de vendas para acompanhar resultados e produtividade."},{key:"utilization",label:"Utilizacao",code:"B",description:"Eventos operacionais por periodo e produto, mostrando o uso real dos servicos."},{key:"financial",label:"Financeiro",code:"C",description:"Movimentacoes financeiras e fluxo de caixa com contas a pagar/receber."}],Q=[{value:"air_ticket",label:p("air_ticket")},{value:"car_rental",label:p("car_rental")},{value:"hotel",label:p("hotel")},{value:"travel_package",label:p("travel_package")},{value:"travel_insurance",label:p("travel_insurance")},{value:"rebooking",label:p("rebooking")},{value:"extra_baggage",label:p("extra_baggage")},{value:"seat",label:p("seat")},{value:"bus_ticket",label:p("bus_ticket")},{value:"train_ticket",label:p("train_ticket")},{value:"transfer",label:p("transfer")}],K={customer:!0,seller:!1,productType:!1,passenger:!1,os:!1,status:!1,dateTravel:!1,dateSale:!0};function S(r){return{...K,...r?.supportedFilters??{}}}function O(r){return Boolean(r?.supportsReportMode)}const G=[{key:"sales",label:"Vendas",description:"Relatorio detalhado de vendas com clientes e vendedores.",category:"performance",requiresDate:!1,supportsReportMode:!0,defaultDateMode:"sale",supportedFilters:{customer:!0,seller:!0,productType:!0,passenger:!0,os:!0,status:!1,dateTravel:!0,dateSale:!0},previewColumns:[{key:"customerName",label:"Cliente"},{key:"productType",label:"Produto/Servico"},{key:"sellDate",label:"Data da emissao"},{key:"paymentMethod",label:"Metodo de pagamento"},{key:"costValue",label:"Custo"},{key:"totalValue",label:"Valor total pago"}]},{key:"sales-by-seller",label:"Vendas por Vendedor",description:"Resumo por vendedor com volume e ticket medio.",category:"performance",requiresDate:!0,supportsReportMode:!1,defaultDateMode:"sale",supportedFilters:{customer:!0,seller:!0,productType:!1,passenger:!1,os:!1,status:!1,dateTravel:!1,dateSale:!0},previewColumns:[{key:"sellerName",label:"Vendedor"},{key:"totalSales",label:"Total vendas"},{key:"totalValue",label:"Valor total"},{key:"avgTicket",label:"Ticket medio"},{key:"totalCommission",label:"Comissao total"}]},{key:"utilization-events",label:"Utilizacao (Eventos)",description:"Eventos de uso por produto no periodo selecionado.",category:"utilization",requiresDate:!0,supportsReportMode:!0,defaultDateMode:"travel",supportedFilters:{customer:!0,seller:!1,productType:!0,passenger:!0,os:!0,status:!1,dateTravel:!0,dateSale:!0},previewColumns:[{key:"eventDateTime",label:"Data/Hora"},{key:"customerName",label:"Cliente"},{key:"passengerName",label:"Passageiro"},{key:"productType",label:"Produto/Servico"},{key:"origin",label:"Origem"},{key:"destination",label:"Destino"},{key:"saleDate",label:"Data da venda"},{key:"costValue",label:"Custo"},{key:"marginValue",label:"Margem"},{key:"totalValue",label:"Valor total pago"}]},{key:"trips",label:"Aereo (Trechos)",description:"Detalhamento de trechos aereos com datas e origens.",category:"utilization",requiresDate:!0,supportsReportMode:!1,defaultDateMode:"travel",supportedFilters:{customer:!0,seller:!1,productType:!1,passenger:!0,os:!0,status:!1,dateTravel:!0,dateSale:!0},previewColumns:[{key:"customerName",label:"Cliente"},{key:"ticketType",label:"Tipo de bilhete"},{key:"airline",label:"Companhia"},{key:"origin",label:"Aeroporto origem"},{key:"originCity",label:"Cidade origem"},{key:"departureDateTime",label:"Data/hora partida"},{key:"value",label:"Valor"},{key:"sellDate",label:"Data da venda"}]},{key:"accounts-payable",label:"Contas a Pagar",description:"Transacoes de despesas com status e datas de pagamento.",category:"financial",requiresDate:!1,supportsStatusFilter:!0,supportsReportMode:!1,defaultDateMode:"sale",supportedFilters:{customer:!0,seller:!1,productType:!1,passenger:!1,os:!1,status:!0,dateTravel:!1,dateSale:!0},previewColumns:[{key:"customerName",label:"Cliente"},{key:"amount",label:"Valor"},{key:"status",label:"Status"},{key:"paymentDate",label:"Data pagamento"}]},{key:"accounts-receivable",label:"Contas a Receber",description:"Transacoes de receitas com status e datas de recebimento.",category:"financial",requiresDate:!1,supportsStatusFilter:!0,supportsReportMode:!1,defaultDateMode:"sale",supportedFilters:{customer:!0,seller:!1,productType:!1,passenger:!1,os:!1,status:!0,dateTravel:!1,dateSale:!0},previewColumns:[{key:"customerName",label:"Cliente"},{key:"amount",label:"Valor"},{key:"status",label:"Status"},{key:"receivedDate",label:"Data recebimento"}]},{key:"cashflow-summary",label:"Fluxo de Caixa",description:"Resumo de entradas, saidas e saldo por periodo.",category:"financial",requiresDate:!0,supportsReportMode:!1,defaultDateMode:"sale",supportedFilters:{customer:!1,seller:!1,productType:!1,passenger:!1,os:!1,status:!1,dateTravel:!1,dateSale:!0},previewColumns:[{key:"period",label:"Periodo"},{key:"totalIncome",label:"Entradas"},{key:"totalExpense",label:"Saidas"},{key:"netValue",label:"Saldo"}]}];var e=d(4650),Y=d(529),$=d(2340);let X=(()=>{class r{constructor(t){this.http=t,this.apiUrl=`${$.N.backendV1Url}/reports`}toYmd(t){if(!t)return;if("string"==typeof t){const i=t.match(/^(\d{4}-\d{2}-\d{2})/);if(i)return i[1]}const o="string"==typeof t?new Date(t):t;return isNaN(o.getTime())?void 0:`${o.getFullYear()}-${String(o.getMonth()+1).padStart(2,"0")}-${String(o.getDate()).padStart(2,"0")}`}buildParams(t,o){let a=new Y.LE;const n=this.toYmd(t.startDate),l=this.toYmd(t.endDate);n&&(a=a.set("start_date",n)),l&&(a=a.set("end_date",l));const i=this.toYmd(t.travelDateStart),c=this.toYmd(t.travelDateEnd);i&&(a=a.set("travel_date_start",i)),c&&(a=a.set("travel_date_end",c));const f=this.toYmd(t.saleDateStart),g=this.toYmd(t.saleDateEnd);f&&(a=a.set("sale_date_start",f)),g&&(a=a.set("sale_date_end",g)),t.statusFilter&&(a=a.set("status_filter",t.statusFilter)),null!=t.sellerId&&""!==String(t.sellerId)&&(a=a.set("seller_id",String(t.sellerId))),null!=t.customerId&&""!==String(t.customerId)&&(a=a.set("customer_id",String(t.customerId))),t.serviceOrderCode&&(a=a.set("service_order_code",String(t.serviceOrderCode))),t.passengerName&&(a=a.set("passenger_name",String(t.passengerName))),t.reportMode&&(a=a.set("report_mode",t.reportMode));const v=t.saleType,T=t.productType;if(T&&(a=a.set("product_type",T)),!T)if("utilization-events"===o){const z=v;z&&(a=a.set("product_type",z))}else v&&(a=a.set("category",v));return a}exportReportCsv(t,o){const a=this.buildParams(o,t);return this.http.get(`${this.apiUrl}/csv/${t}`,{params:a,responseType:"blob",headers:{"mtm-token":`Bearer ${localStorage.getItem("token")??""}`}})}exportReportPdf(t,o){const a=this.buildParams(o,t);return this.http.get(`${this.apiUrl}/pdf/${t}`,{params:a,responseType:"blob",headers:{"mtm-token":`Bearer ${localStorage.getItem("token")??""}`}})}exportSalesReport(t){return this.exportReportCsv("sales",t)}exportTripsReport(t){return this.exportReportCsv("trips",t)}exportAccountsPayableReport(t){return this.exportReportCsv("accounts-payable",t)}exportAccountsReceivableReport(t){return this.exportReportCsv("accounts-receivable",t)}downloadFile(t,o){const a=window.URL.createObjectURL(t),n=document.createElement("a");n.href=a,n.download=o,document.body.appendChild(n),n.click(),document.body.removeChild(n),window.URL.revokeObjectURL(a)}getReportPreview(t,o){const a=this.buildParams(o,t);if(!$.N.production){const n=this.toYmd(o.startDate),l=this.toYmd(o.endDate);console.debug("[Reports] preview params",{start_date:n,end_date:l,travel_date_start:this.toYmd(o.travelDateStart),travel_date_end:this.toYmd(o.travelDateEnd),sale_date_start:this.toYmd(o.saleDateStart),sale_date_end:this.toYmd(o.saleDateEnd),seller_id:o.sellerId,category:"utilization-events"===t?void 0:o.saleType,product_type:"utilization-events"===t?o.productType||o.saleType:void 0,status_filter:o.statusFilter,customer_id:o.customerId,service_order_code:o.serviceOrderCode,passenger_name:o.passengerName,report_mode:o.reportMode,reportType:t})}return this.http.get(`${this.apiUrl}/preview/${t}`,{params:a,headers:{"mtm-token":`Bearer ${localStorage.getItem("token")??""}`,"X-Tenant-Id":localStorage.getItem("tenant")??""}}).pipe((0,P.U)(n=>({data:n.data??[],total:"number"==typeof n.total_count?n.total_count:n.total??(n.data?n.data.length:0)})))}}return r.\u0275fac=function(t){return new(t||r)(e.LFG(Y.eN))},r.\u0275prov=e.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})();var W=d(4988),ee=d(3987),te=d(6821);function oe(r,s){if(1&r&&e._UZ(0,"mat-tab",26),2&r){const t=s.$implicit;e.Q6J("label",t.code+") "+t.label)}}function ae(r,s){if(1&r&&(e.TgZ(0,"mat-option",27),e._uU(1),e.qZA()),2&r){const t=s.$implicit;e.Q6J("value",t.key),e.xp6(1),e.hij(" ",t.label," ")}}function re(r,s){if(1&r&&(e.TgZ(0,"mat-hint"),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.selectedReport.description)}}function ne(r,s){if(1&r&&(e.TgZ(0,"mat-option",27),e._uU(1),e.qZA()),2&r){const t=s.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.label," ")}}function se(r,s){if(1&r&&(e.TgZ(0,"mat-form-field",10)(1,"mat-label"),e._uU(2,"Tipo de relatorio"),e.qZA(),e.TgZ(3,"mat-select",28),e.YNc(4,ne,2,2,"mat-option",12),e.qZA()()),2&r){const t=e.oxw();e.xp6(4),e.Q6J("ngForOf",t.reportModeOptions)}}function ie(r,s){if(1&r&&(e.TgZ(0,"mat-option",33),e._uU(1),e.qZA()),2&r){const t=s.$implicit,o=e.oxw(2);e.Q6J("value",t.value)("disabled","travel"===t.value&&!o.supportedFilters.dateTravel||"sale"===t.value&&!o.supportedFilters.dateSale||"both"===t.value&&(!o.supportedFilters.dateTravel||!o.supportedFilters.dateSale)),e.xp6(1),e.hij(" ",t.label," ")}}function le(r,s){1&r&&(e.TgZ(0,"mat-hint"),e._uU(1,"Este relatorio nao usa data de viagem."),e.qZA())}function de(r,s){if(1&r&&(e.TgZ(0,"div",9)(1,"mat-form-field",10)(2,"mat-label"),e._uU(3,"Viagem - data inicial"),e.qZA(),e._UZ(4,"input",34)(5,"mat-datepicker-toggle",35)(6,"mat-datepicker",null,36),e.qZA(),e.TgZ(8,"mat-form-field",10)(9,"mat-label"),e._uU(10,"Viagem - data final"),e.qZA(),e._UZ(11,"input",37)(12,"mat-datepicker-toggle",35)(13,"mat-datepicker",null,38),e.qZA()()),2&r){const t=e.MAs(7),o=e.MAs(14);e.xp6(4),e.Q6J("matDatepicker",t),e.xp6(1),e.Q6J("for",t),e.xp6(6),e.Q6J("matDatepicker",o),e.xp6(1),e.Q6J("for",o)}}function ce(r,s){if(1&r&&(e.TgZ(0,"div",9)(1,"mat-form-field",10)(2,"mat-label"),e._uU(3,"Lancamento - data inicial"),e.qZA(),e._UZ(4,"input",39)(5,"mat-datepicker-toggle",35)(6,"mat-datepicker",null,40),e.qZA(),e.TgZ(8,"mat-form-field",10)(9,"mat-label"),e._uU(10,"Lancamento - data final"),e.qZA(),e._UZ(11,"input",41)(12,"mat-datepicker-toggle",35)(13,"mat-datepicker",null,42),e.qZA()()),2&r){const t=e.MAs(7),o=e.MAs(14);e.xp6(4),e.Q6J("matDatepicker",t),e.xp6(1),e.Q6J("for",t),e.xp6(6),e.Q6J("matDatepicker",o),e.xp6(1),e.Q6J("for",o)}}function pe(r,s){if(1&r&&(e.TgZ(0,"div",29)(1,"div",30),e._uU(2,"Periodo"),e.qZA(),e.TgZ(3,"div",9)(4,"mat-form-field",10)(5,"mat-label"),e._uU(6,"Filtrar por"),e.qZA(),e.TgZ(7,"mat-select",31),e.YNc(8,ie,2,3,"mat-option",32),e.qZA(),e.YNc(9,le,2,0,"mat-hint",13),e.qZA()(),e.YNc(10,de,15,4,"div",16),e.YNc(11,ce,15,4,"div",16),e.qZA()),2&r){const t=e.oxw();e.xp6(8),e.Q6J("ngForOf",t.dateModeOptions),e.xp6(1),e.Q6J("ngIf",!t.supportedFilters.dateTravel),e.xp6(1),e.Q6J("ngIf",t.showTravelDates),e.xp6(1),e.Q6J("ngIf",t.showSaleDates)}}function ue(r,s){if(1&r){const t=e.EpF();e.TgZ(0,"button",48),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.clearCustomer())}),e.TgZ(1,"mat-icon"),e._uU(2,"close"),e.qZA()()}}function me(r,s){1&r&&(e.TgZ(0,"mat-option",49),e._uU(1," Nenhum cliente encontrado "),e.qZA())}function fe(r,s){if(1&r&&(e.TgZ(0,"mat-option",27)(1,"div",50)(2,"div",51),e._uU(3),e.qZA(),e.TgZ(4,"div",52),e._uU(5),e.qZA()()()),2&r){const t=s.$implicit,o=e.oxw(3);e.Q6J("value",t),e.xp6(3),e.Oqu(o.displayCustomerName(t)),e.xp6(2),e.hij(" CPF/CNPJ: ",(null==t||null==t.person?null:t.person.cnpj)||(null==t||null==t.person?null:t.person.cpf)||(null==t?null:t.cnpj)||(null==t?null:t.cpf)||"\u2014"," ")}}function ge(r,s){if(1&r){const t=e.EpF();e.TgZ(0,"mat-form-field",10)(1,"mat-label"),e._uU(2,"Cliente (Empresa)"),e.qZA(),e._UZ(3,"input",43),e.YNc(4,ue,3,0,"button",44),e.TgZ(5,"mat-hint"),e._uU(6,"Busque por nome ou CPF/CNPJ"),e.qZA(),e.TgZ(7,"mat-autocomplete",45,46),e.NdJ("optionSelected",function(a){e.CHM(t);const n=e.oxw(2);return e.KtG(n.onCustomerSelected(a))}),e.TgZ(9,"mat-option",27),e._uU(10,"Todos"),e.qZA(),e.YNc(11,me,2,0,"mat-option",47),e.YNc(12,fe,6,3,"mat-option",12),e.ALo(13,"async"),e.qZA()()}if(2&r){const t=e.MAs(8),o=e.oxw(2);let a;e.xp6(3),e.Q6J("matAutocomplete",t),e.xp6(1),e.Q6J("ngIf",null==(a=o.reportForm.get("customerSearch"))?null:a.value),e.xp6(3),e.Q6J("displayWith",o.displayCustomerName),e.xp6(2),e.Q6J("value",null),e.xp6(2),e.Q6J("ngIf",o.customerNotFound),e.xp6(1),e.Q6J("ngForOf",e.lcZ(13,6,o.customerOptions$))}}function he(r,s){if(1&r&&(e.TgZ(0,"mat-option",27),e._uU(1),e.qZA()),2&r){const t=s.$implicit;e.Q6J("value",t.value),e.xp6(1),e.hij(" ",t.label," ")}}function _e(r,s){if(1&r&&(e.TgZ(0,"mat-form-field",10)(1,"mat-label"),e._uU(2,"Produto/Tipo de servico"),e.qZA(),e.TgZ(3,"mat-select",53)(4,"mat-option",54),e._uU(5,"Todos"),e.qZA(),e.YNc(6,he,2,2,"mat-option",12),e.qZA()()),2&r){const t=e.oxw(2);e.xp6(6),e.Q6J("ngForOf",t.productTypeOptions)}}function ve(r,s){if(1&r){const t=e.EpF();e.TgZ(0,"button",58),e.NdJ("click",function(){e.CHM(t);const a=e.oxw(3);return e.KtG(a.clearSeller())}),e.TgZ(1,"mat-icon"),e._uU(2,"close"),e.qZA()()}}function Ce(r,s){1&r&&(e.TgZ(0,"mat-option",49),e._uU(1," Nenhum vendedor encontrado "),e.qZA())}function be(r,s){if(1&r&&(e.TgZ(0,"mat-option",27)(1,"div",59)(2,"div",60),e._uU(3),e.qZA(),e.TgZ(4,"div",61),e._uU(5),e.qZA()()()),2&r){const t=s.$implicit,o=e.oxw(3);e.Q6J("value",t),e.xp6(3),e.Oqu(o.getSellerName(t)||o.displaySellerName(t)),e.xp6(2),e.Oqu(o.getSellerEmail(t)||"\u2014")}}function ye(r,s){if(1&r){const t=e.EpF();e.TgZ(0,"mat-form-field",10)(1,"mat-label"),e._uU(2,"Vendedor"),e.qZA(),e._UZ(3,"input",55),e.YNc(4,ve,3,0,"button",56),e.TgZ(5,"mat-hint"),e._uU(6,"Busque por nome ou email"),e.qZA(),e.TgZ(7,"mat-autocomplete",45,57),e.NdJ("optionSelected",function(a){e.CHM(t);const n=e.oxw(2);return e.KtG(n.onSellerSelected(a))}),e.TgZ(9,"mat-option",27),e._uU(10,"Todos"),e.qZA(),e.YNc(11,Ce,2,0,"mat-option",47),e.YNc(12,be,6,3,"mat-option",12),e.ALo(13,"async"),e.qZA()()}if(2&r){const t=e.MAs(8),o=e.oxw(2);let a;e.xp6(3),e.Q6J("matAutocomplete",t),e.xp6(1),e.Q6J("ngIf",null==(a=o.reportForm.get("sellerSearch"))?null:a.value),e.xp6(3),e.Q6J("displayWith",o.displaySellerName),e.xp6(2),e.Q6J("value",null),e.xp6(2),e.Q6J("ngIf",o.sellerNotFound),e.xp6(1),e.Q6J("ngForOf",e.lcZ(13,6,o.sellerOptions$))}}function xe(r,s){if(1&r&&(e.TgZ(0,"div",9),e.YNc(1,ge,14,8,"mat-form-field",14),e.YNc(2,_e,7,1,"mat-form-field",14),e.YNc(3,ye,14,8,"mat-form-field",14),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Q6J("ngIf",t.supportedFilters.customer),e.xp6(1),e.Q6J("ngIf",t.supportedFilters.productType),e.xp6(1),e.Q6J("ngIf",t.supportedFilters.seller)}}function Te(r,s){1&r&&(e.TgZ(0,"mat-form-field",10)(1,"mat-label"),e._uU(2,"Passageiro"),e.qZA(),e._UZ(3,"input",63),e.qZA())}function Me(r,s){1&r&&(e.TgZ(0,"mat-form-field",10)(1,"mat-label"),e._uU(2,"OS"),e.qZA(),e._UZ(3,"input",64),e.qZA())}function De(r,s){1&r&&(e.TgZ(0,"mat-form-field",10)(1,"mat-label"),e._uU(2,"Status"),e.qZA(),e.TgZ(3,"mat-select",65)(4,"mat-option",54),e._uU(5,"Todos"),e.qZA(),e.TgZ(6,"mat-option",66),e._uU(7,"Pendente"),e.qZA(),e.TgZ(8,"mat-option",67),e._uU(9,"Concluido"),e.qZA(),e.TgZ(10,"mat-option",68),e._uU(11,"Pago"),e.qZA(),e.TgZ(12,"mat-option",69),e._uU(13,"Recebido"),e.qZA(),e.TgZ(14,"mat-option",70),e._uU(15,"Atrasado"),e.qZA(),e.TgZ(16,"mat-option",71),e._uU(17,"Faturado"),e.qZA()()())}function Pe(r,s){if(1&r){const t=e.EpF();e.TgZ(0,"mat-expansion-panel",62),e.NdJ("expandedChange",function(a){e.CHM(t);const n=e.oxw();return e.KtG(n.advancedOpen=a)}),e.TgZ(1,"mat-expansion-panel-header")(2,"mat-panel-title"),e._uU(3,"Filtros avancados"),e.qZA(),e.TgZ(4,"mat-panel-description"),e._uU(5,"Passageiro, OS, status"),e.qZA()(),e.TgZ(6,"div",9),e.YNc(7,Te,4,0,"mat-form-field",14),e.YNc(8,Me,4,0,"mat-form-field",14),e.YNc(9,De,18,0,"mat-form-field",14),e.qZA()()}if(2&r){const t=e.oxw();e.Q6J("expanded",t.advancedOpen),e.xp6(7),e.Q6J("ngIf",t.supportedFilters.passenger),e.xp6(1),e.Q6J("ngIf",t.supportedFilters.os),e.xp6(1),e.Q6J("ngIf",t.supportedFilters.status)}}function Se(r,s){if(1&r&&(e.TgZ(0,"div",72),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.hij(" ",t.summaryLine," ")}}function Oe(r,s){if(1&r&&(e.TgZ(0,"span",73),e._uU(1),e.qZA()),2&r){const t=e.oxw();e.xp6(1),e.Oqu(t.exportStatusMessage)}}function Re(r,s){1&r&&(e.TgZ(0,"div",74),e._UZ(1,"mat-spinner"),e.TgZ(2,"p"),e._uU(3,"Processando relatorio..."),e.qZA()())}function Fe(r,s){if(1&r&&(e.TgZ(0,"th",84),e._uU(1),e.qZA()),2&r){const t=e.oxw().$implicit,o=e.oxw(2);e.xp6(1),e.Oqu(o.getColumnLabel(t))}}function ke(r,s){if(1&r&&(e.TgZ(0,"td",85),e._uU(1),e.qZA()),2&r){const t=s.$implicit,o=e.oxw().$implicit,a=e.oxw(2);e.xp6(1),e.Oqu(a.formatCellValue(o,t[o]))}}function Ze(r,s){1&r&&(e.ynx(0,81),e.YNc(1,Fe,2,1,"th",82),e.YNc(2,ke,2,1,"td",83),e.BQk()),2&r&&e.Q6J("matColumnDef",s.$implicit)}function Ae(r,s){1&r&&e._UZ(0,"tr",86)}function Ie(r,s){1&r&&e._UZ(0,"tr",87)}function Ne(r,s){if(1&r&&(e.TgZ(0,"mat-card",75)(1,"mat-card-header")(2,"mat-card-title"),e._uU(3),e.qZA(),e.TgZ(4,"mat-card-subtitle"),e._uU(5),e.qZA()(),e.TgZ(6,"mat-card-content")(7,"div",76)(8,"table",77),e.YNc(9,Ze,3,1,"ng-container",78),e.YNc(10,Ae,1,0,"tr",79),e.YNc(11,Ie,1,0,"tr",80),e.qZA()()()()),2&r){const t=e.oxw();e.xp6(3),e.hij("Preview - ",null==t.selectedReport?null:t.selectedReport.label,""),e.xp6(2),e.AsE("",t.previewData.length," de ",t.previewTotal," registro(s)"),e.xp6(3),e.Q6J("dataSource",t.previewData),e.xp6(1),e.Q6J("ngForOf",t.displayedColumns),e.xp6(1),e.Q6J("matHeaderRowDef",t.displayedColumns),e.xp6(1),e.Q6J("matRowDefColumns",t.displayedColumns)}}const we=[{path:"",component:(()=>{class r{constructor(t,o,a,n,l,i){this.fb=t,this.reportsService=o,this.snackBar=a,this.feedbackService=n,this.customerService=l,this.sellerService=i,this.categories=j,this.reports=G,this.selectedCategory="performance",this.filteredReports=[],this.selectedReport=null,this.isLoading=!1,this.previewData=[],this.previewTotal=0,this.displayedColumns=[],this.currentPreviewColumns=[],this.selectedCategoryIndex=0,this.reportModeOptions=[{value:"CLIENT",label:"Relatorio para Cliente"},{value:"FINANCIAL",label:"Relatorio Geral / Financeiro"}],this.customerOptions$=(0,h.of)([]),this.sellerOptions$=(0,h.of)([]),this.exportStatusMessage="",this.advancedOpen=!1,this.dateModeOptions=[{value:"travel",label:"Viagem (operacional)"},{value:"sale",label:"Lancamento (financeiro)"},{value:"both",label:"Ambos (avancado)"}],this.clientReportKeys=new Set(["utilization-events"]),this.utilizationClientColumns=[{key:"customerName",label:"Cliente"},{key:"passengerName",label:"Passageiro"},{key:"serviceType",label:"Produto/Servico"},{key:"origin",label:"Origem"},{key:"destination",label:"Destino"},{key:"saleDate",label:"Data da emissao"},{key:"totalValue",label:"Valor total pago"}],this.utilizationFinancialColumns=[{key:"eventDateTime",label:"Data/Hora"},{key:"customerName",label:"Cliente"},{key:"passengerName",label:"Passageiro"},{key:"productType",label:"Produto/Servico"},{key:"origin",label:"Origem"},{key:"destination",label:"Destino"},{key:"saleDate",label:"Data da venda"},{key:"costValue",label:"Custo"},{key:"marginValue",label:"Margem"},{key:"totalValue",label:"Valor total pago"}],this.ticketTypeLabels={one_way:"Ida",round_trip:"Ida e volta",multiple_routes:"Multiplos trechos",multi_city:"Multiplos trechos"},this.eventLabelLabels={ida:"Ida",volta:"Volta",retirada:"Retirada",devolucao:"Devolucao","check-in":"Check-in","check-out":"Check-out",inicio:"Inicio",retorno:"Retorno",fim:"Fim",embarque:"Embarque",viagem:"Viagem",transfer:"Transfer",trecho:"Trecho"},this.productTypeLabels=Q.reduce((c,f)=>(c[f.value]=f.label,c),{}),this.statusLabels={"accounts-payable":{pending:"Pendente",completed:"Pago",paid:"Pago",delayed:"Atrasado",billed:"Faturado"},"accounts-receivable":{pending:"Pendente",completed:"Recebido",received:"Recebido",delayed:"Atrasado",billed:"Faturado"}},this.productTypeOptions=Q,this.customerNotFound=!1,this.sellerNotFound=!1,this.reportForm=this.fb.group({reportKey:["",u.kI.required],reportMode:["FINANCIAL",u.kI.required],dateMode:["sale",u.kI.required],travelDateStart:[""],travelDateEnd:[""],saleDateStart:[""],saleDateEnd:[""],customerSearch:[""],customerId:[""],sellerSearch:[""],sellerId:[""],productType:[""],passengerName:[""],serviceOrderCode:[""],statusFilter:[""]})}ngOnInit(){this.selectedCategoryIndex=this.categories.findIndex(t=>t.key===this.selectedCategory),this.filteredReports=this.filterReports(this.selectedCategory,this.getReportMode()),this.reportForm.get("reportMode")?.valueChanges.subscribe(t=>{const o=t||"FINANCIAL";if("CLIENT"===o){const n=this.categories.findIndex(l=>"utilization"===l.key);n>=0&&(this.selectedCategory="utilization",this.selectedCategoryIndex=n)}this.filteredReports=this.filterReports(this.selectedCategory,o);const a=this.reportForm.get("reportKey")?.value;a&&!this.filteredReports.some(n=>n.key===a)&&(this.selectedReport=null,this.reportForm.patchValue({reportKey:""},{emitEvent:!1})),this.resetPreview()}),this.reportForm.get("reportKey")?.valueChanges.subscribe(t=>{this.selectedReport=this.reports.find(o=>o.key===t)||null,this.applyReportDefaultsAndCleanup(),this.resetPreview()}),this.reportForm.get("dateMode")?.valueChanges.subscribe(()=>{this.applyDateModeCleanup()}),this.setupCustomerAutocomplete(),this.setupSellerAutocomplete()}onCategoryChange(t){const o=this.getReportMode(),a=this.categories[t]?.key||"performance";if("CLIENT"===o){const n=this.categories.findIndex(l=>"utilization"===l.key);this.selectedCategory="utilization",this.selectedCategoryIndex=n>=0?n:t}else this.selectedCategory=a,this.selectedCategoryIndex=t;this.filteredReports=this.filterReports(this.selectedCategory,o),this.selectedReport=null,this.reportForm.patchValue({reportKey:"",productType:"",sellerId:"",sellerSearch:"",passengerName:"",serviceOrderCode:"",statusFilter:""},{emitEvent:!1}),this.advancedOpen=!1,this.resetPreview()}filterReports(t,o){let a=this.reports.filter(n=>n.category===t);return"CLIENT"===o&&(a=a.filter(n=>this.clientReportKeys.has(n.key))),a}setupCustomerAutocomplete(){const t=this.reportForm.get("customerSearch");if(!t)return;const o=i=>(i||"").replace(/\D/g,"");this.customerOptions$=t.valueChanges.pipe((0,U.b)(300),(0,q.x)(),(0,J.w)(i=>{if(i&&"object"==typeof i)return this.customerNotFound=!1,(0,h.of)([]);const c=String(i||"").trim();if("string"==typeof t.value&&this.reportForm.patchValue({customerId:""},{emitEvent:!1}),!(i=>{const c=(i||"").trim();if(!c)return!1;const f=o(c);return/^\d/.test(c)?f.length>=3:c.length>=3})(c))return this.customerNotFound=!1,(0,h.of)([]);const g=o(c);return(/^\d/.test(c)&&g.length>=3?this.customerService.search({cpf:g,per_page:20}):this.customerService.search({name:c,per_page:20})).pipe((0,L.K)(()=>(0,h.of)([])))}),(0,P.U)(i=>{const c=Array.isArray(i)?i:[];return this.customerNotFound=(this.reportForm.get("customerSearch")?.value||"").toString().trim().length>0&&0===c.length,c})),t.valueChanges.subscribe(i=>{if(null===i)return void this.reportForm.patchValue({customerId:""},{emitEvent:!1});if("string"==typeof i){if(!this.reportForm.get("customerId")?.value)return;return void this.reportForm.patchValue({customerId:""},{emitEvent:!1})}const c=(i=>{const c=(i=>i?.person??i)(i);return o(c?.cnpj||c?.cpf||"")})(i);c&&c.length<11&&this.reportForm.patchValue({customerId:""},{emitEvent:!1})})}setupSellerAutocomplete(){const t=this.reportForm.get("sellerSearch");t&&(this.sellerOptions$=t.valueChanges.pipe((0,U.b)(300),(0,q.x)(),(0,J.w)(a=>{if(a&&"object"==typeof a)return this.sellerNotFound=!1,(0,h.of)([]);const n=String(a||"").trim();return"string"==typeof t.value&&this.reportForm.patchValue({sellerId:""},{emitEvent:!1}),(a=>(a||"").trim().length>=2)(n)?this.sellerService.search({name:n,email:n,per_page:20}).pipe((0,L.K)(()=>(0,h.of)([]))):(this.sellerNotFound=!1,(0,h.of)([]))}),(0,P.U)(a=>{const n=Array.isArray(a)?a:[];return this.sellerNotFound=(this.reportForm.get("sellerSearch")?.value||"").toString().trim().length>0&&0===n.length,n})),t.valueChanges.subscribe(a=>{if(null!==a){if("string"==typeof a){if(!this.reportForm.get("sellerId")?.value)return;this.reportForm.patchValue({sellerId:""},{emitEvent:!1})}}else this.reportForm.patchValue({sellerId:""},{emitEvent:!1})}))}onCustomerSelected(t){const o=t.option.value;null!==o?(this.reportForm.patchValue({customerId:(o?.person_id??o?.id??(o?.person??o)?.id)||"",customerSearch:o},{emitEvent:!1}),this.customerNotFound=!1):this.reportForm.patchValue({customerId:"",customerSearch:""},{emitEvent:!1})}onSellerSelected(t){const o=t.option.value;if(null===o)return void this.reportForm.patchValue({sellerId:"",sellerSearch:""},{emitEvent:!1});const a=o?.id;this.reportForm.patchValue({sellerId:a||"",sellerSearch:o},{emitEvent:!1}),this.sellerNotFound=!1}clearCustomer(){this.reportForm.patchValue({customerSearch:"",customerId:""},{emitEvent:!1}),this.customerNotFound=!1}clearSeller(){this.reportForm.patchValue({sellerSearch:"",sellerId:""},{emitEvent:!1}),this.sellerNotFound=!1}displayCustomerName(t){if(null===t)return"Todos";if(!t)return"";if("string"==typeof t)return t;const o=t.person??t,a=o.fantasy_name||o.company_name||[o.first_name,o.surname].filter(Boolean).join(" ")||o.first_name||"",n=o.cnpj||o.cpf;return`${a} \u2014 ${n?String(n):"\u2014"}`}displaySellerName(t){if(null===t)return"Todos";if(!t)return"";if("string"==typeof t)return t;const o=t?.person??{},a=[o?.first_name,o?.surname].filter(Boolean).join(" ")||o?.first_name||"",n=o?.email||"";return n?`${a} \u2014 ${n}`:a}getSellerEmail(t){return t&&t?.person?.email||""}getSellerName(t){if(!t)return"";const o=t?.person??{};return[o?.first_name,o?.surname].filter(Boolean).join(" ")||o?.first_name||""}buildCustomerLabel(t){return this.displayCustomerName(t)}resetPreview(){this.previewData=[],this.previewTotal=0,this.displayedColumns=[],this.currentPreviewColumns=[],this.exportStatusMessage=""}get supportsReportMode(){return O(this.selectedReport)}get supportedFilters(){return S(this.selectedReport)}get dateMode(){return this.reportForm.get("dateMode")?.value||"sale"}get showTravelDates(){return"travel"===this.dateMode||"both"===this.dateMode}get showSaleDates(){return"sale"===this.dateMode||"both"===this.dateMode}applyReportDefaultsAndCleanup(){const t=this.selectedReport;if(!t)return void(this.advancedOpen=!1);const o=function H(r){return r?.defaultDateMode??"sale"}(t),a=O(t)?this.getReportMode():"FINANCIAL";this.reportForm.patchValue({reportMode:a,dateMode:o},{emitEvent:!1}),this.advancedOpen=Boolean(t.defaultAdvancedOpen),this.cleanupUnsupportedFilters(),this.applyDateModeCleanup()}cleanupUnsupportedFilters(){const t=S(this.selectedReport);t.customer||this.reportForm.patchValue({customerSearch:"",customerId:""},{emitEvent:!1}),t.seller||this.reportForm.patchValue({sellerSearch:"",sellerId:""},{emitEvent:!1}),t.productType||this.reportForm.patchValue({productType:""},{emitEvent:!1}),t.passenger||this.reportForm.patchValue({passengerName:""},{emitEvent:!1}),t.os||this.reportForm.patchValue({serviceOrderCode:""},{emitEvent:!1}),t.status||this.reportForm.patchValue({statusFilter:""},{emitEvent:!1}),O(this.selectedReport)||this.reportForm.patchValue({reportMode:"FINANCIAL"},{emitEvent:!1})}applyDateModeCleanup(){const t=S(this.selectedReport),o=this.dateMode;"travel"!==o||t.dateTravel||!t.dateSale?"sale"!==o||t.dateSale||!t.dateTravel?"both"!==o||t.dateTravel&&t.dateSale?("travel"===o&&this.reportForm.patchValue({saleDateStart:"",saleDateEnd:""},{emitEvent:!1}),"sale"===o&&this.reportForm.patchValue({travelDateStart:"",travelDateEnd:""},{emitEvent:!1})):this.reportForm.patchValue({dateMode:t.dateTravel?"travel":"sale"},{emitEvent:!1}):this.reportForm.patchValue({dateMode:"travel"},{emitEvent:!1}):this.reportForm.patchValue({dateMode:"sale"},{emitEvent:!1})}validateDateRange(){const{travelDateStart:t,travelDateEnd:o,saleDateStart:a,saleDateEnd:n}=this.reportForm.value;if(this.showTravelDates){if(t&&!o||!t&&o)return this.snackBar.open("Informe data inicial e final da viagem.","Fechar",{duration:3e3}),!1;if(t&&o){const l=new Date(t);if(new Date(o)<l)return this.snackBar.open("A data final da viagem nao pode ser menor que a data inicial.","Fechar",{duration:3e3}),!1}}if(this.showSaleDates){if(a&&!n||!a&&n)return this.snackBar.open("Informe data inicial e final de lancamento.","Fechar",{duration:3e3}),!1;if(a&&n){const l=new Date(a);if(new Date(n)<l)return this.snackBar.open("A data final de lancamento nao pode ser menor que a data inicial.","Fechar",{duration:3e3}),!1}}return!0}getFilters(){const t=this.reportForm.value;return{travelDateStart:this.showTravelDates&&t.travelDateStart||void 0,travelDateEnd:this.showTravelDates&&t.travelDateEnd||void 0,saleDateStart:this.showSaleDates&&t.saleDateStart||void 0,saleDateEnd:this.showSaleDates&&t.saleDateEnd||void 0,customerId:this.supportedFilters.customer&&t.customerId||void 0,passengerName:this.supportedFilters.passenger&&t.passengerName||void 0,serviceOrderCode:this.supportedFilters.os&&t.serviceOrderCode||void 0,productType:this.supportedFilters.productType&&t.productType||void 0,reportMode:this.supportsReportMode?t.reportMode||void 0:"FINANCIAL",statusFilter:this.supportedFilters.status&&t.statusFilter||void 0,sellerId:this.supportedFilters.seller&&t.sellerId||void 0}}getReportMode(){return this.reportForm.get("reportMode")?.value||"FINANCIAL"}requiresAnyRange(t){return"utilization-events"===t||"trips"===t}requiresSaleRange(t){return"sales-by-seller"===t||"cashflow-summary"===t}getActiveRangeKind(){const{travelDateStart:t,travelDateEnd:o,saleDateStart:a,saleDateEnd:n}=this.reportForm.value,l=!!t&&!!o,i=!!a&&!!n;return l&&i?"both":l?"travel":i?"sale":"none"}ensureReportRequirements(t,o){const a=this.dateMode;if(this.requiresSaleRange(t)){if("sale"!==a&&"both"!==a)return this.snackBar.open("Este relatorio exige data de lancamento. Troque o filtro de periodo para Lancamento.","Fechar",{duration:4e3}),!1;const n=this.getActiveRangeKind();if("sale"!==n&&"both"!==n)return this.snackBar.open("visualizar"===o?"Selecione o periodo de lancamento para visualizar.":"Selecione o periodo de lancamento para exportar.","Fechar",{duration:3e3}),!1}return!this.requiresAnyRange(t)||"none"!==this.getActiveRangeKind()||(this.snackBar.open("visualizar"===o?"Selecione data da viagem ou data de lancamento para visualizar.":"Selecione data da viagem ou data de lancamento para exportar.","Fechar",{duration:3e3}),!1)}onPreview(){if(!this.selectedReport)return void this.snackBar.open("Selecione um relatorio valido","Fechar",{duration:3e3});const t=this.selectedReport.key,o=this.getReportMode();if(!this.ensureReportRequirements(t,"visualizar")||!this.validateDateRange())return;this.isLoading=!0,this.exportStatusMessage="";const a=this.getFilters();this.reportsService.getReportPreview(this.selectedReport.key,a).pipe((0,V.x)(()=>this.isLoading=!1)).subscribe({next:n=>{this.previewData=n.data||[],this.previewTotal="number"==typeof n.total?n.total:this.previewData.length;const l=this.getPreviewColumns(this.selectedReport,o);this.currentPreviewColumns=l,this.displayedColumns=l.map(i=>i.key),0===this.previewData.length&&this.snackBar.open("Nenhum dado encontrado para os filtros selecionados","Fechar",{duration:3e3})},error:n=>{this.feedbackService.showHttpError(n,{fallbackMessage:"Nao foi possivel carregar dados do relatorio."})}})}onExport(t){if(!this.selectedReport)return void this.snackBar.open("Selecione um relatorio valido","Fechar",{duration:3e3});const o=this.selectedReport.key;if(!this.ensureReportRequirements(o,"exportar"))return;const a=this.getActiveRangeKind();if(!this.requiresAnyRange(o)&&!this.requiresSaleRange(o)&&"none"===a&&this.snackBar.open("Exportacao sem periodo pode demorar.","Fechar",{duration:3e3}),!this.validateDateRange())return;const n=this.getFilters(),l="pdf"===t?this.reportsService.exportReportPdf(this.selectedReport.key,n):this.reportsService.exportReportCsv(this.selectedReport.key,n),i=(new Date).toISOString().split("T")[0],f=`${this.selectedReport.key}_${i}.${"pdf"===t?"pdf":"csv"}`;this.isLoading=!0,this.exportStatusMessage="Gerando exportacao...",l.pipe((0,V.x)(()=>this.isLoading=!1)).subscribe({next:g=>{this.reportsService.downloadFile(g,f),this.exportStatusMessage="Exportacao concluida com sucesso.",this.snackBar.open("Exportacao concluida com sucesso!","Fechar",{duration:3e3})},error:g=>{this.exportStatusMessage="Erro ao exportar.",this.feedbackService.showHttpError(g,{fallbackMessage:"Nao foi possivel exportar o relatorio."})}})}getColumnLabel(t){return(this.currentPreviewColumns.length?this.currentPreviewColumns:this.selectedReport?.previewColumns||[]).find(a=>a.key===t)?.label||t}formatCellValue(t,o){if(null==o||""===o)return"-";if("ticketType"===t){const a=String(o).toLowerCase();return this.ticketTypeLabels[a]||String(o)}if("status"===t){const a=this.selectedReport?.key||"",n=String(o).toLowerCase();return this.statusLabels[a]?.[n]||String(o)}if("productType"===t||"serviceType"===t)return p(String(o).toLowerCase());if("eventLabel"===t){const a=String(o).toLowerCase();return this.eventLabelLabels[a]||String(o)}return String(o)}get summaryLine(){const t=this.selectedReport;if(!t)return"";const o=this.reportForm.value,a=[];a.push(`Relatorio: ${t.label}`);const n=this.dateMode,l=i=>{try{if(!i)return"";const c=new Date(i);return Number.isNaN(c.getTime())?String(i):c.toISOString().slice(0,10)}catch{return String(i)}};if(a.push("travel"===n?`Periodo: Viagem ${l(o.travelDateStart)} a ${l(o.travelDateEnd)}`:"sale"===n?`Periodo: Lancamento ${l(o.saleDateStart)} a ${l(o.saleDateEnd)}`:`Periodo: Viagem ${l(o.travelDateStart)} a ${l(o.travelDateEnd)} | Lancamento ${l(o.saleDateStart)} a ${l(o.saleDateEnd)}`),this.supportedFilters.customer&&o.customerId){const i="string"==typeof o.customerSearch?o.customerSearch:this.displayCustomerName(o.customerSearch);a.push(`Cliente: ${i||o.customerId}`)}if(this.supportedFilters.productType&&o.productType&&a.push(`Produto: ${p(String(o.productType).toLowerCase())}`),this.supportedFilters.seller&&o.sellerId){const i="string"==typeof o.sellerSearch?o.sellerSearch:this.displaySellerName(o.sellerSearch);a.push(`Vendedor: ${i||o.sellerId}`)}return a.join("  |  ")}get selectedCategoryDescription(){return this.categories.find(t=>t.key===this.selectedCategory)?.description||""}getPreviewColumns(t,o){return"utilization-events"===t.key?"CLIENT"===o?this.utilizationClientColumns:this.utilizationFinancialColumns:t.previewColumns}}return r.\u0275fac=function(t){return new(t||r)(e.Y36(u.qu),e.Y36(X),e.Y36(w.ux),e.Y36(W.T),e.Y36(ee.v),e.Y36(te.n))},r.\u0275cmp=e.Xpm({type:r,selectors:[["app-reports-dashboard"]],decls:45,vars:17,consts:[[1,"reports-dashboard"],[1,"page-header"],[1,"page-description"],[1,"category-card"],[3,"selectedIndex","selectedIndexChange"],[3,"label",4,"ngFor","ngForOf"],[1,"category-description"],[1,"filter-card"],[1,"filter-form",3,"formGroup"],[1,"filter-row"],["appearance","outline"],["formControlName","reportKey"],[3,"value",4,"ngFor","ngForOf"],[4,"ngIf"],["appearance","outline",4,"ngIf"],["class","date-group",4,"ngIf"],["class","filter-row",4,"ngIf"],["class","advanced-panel",3,"expanded","expandedChange",4,"ngIf"],["class","summary-line",4,"ngIf"],[1,"actions"],["mat-raised-button","","color","primary",3,"disabled","click"],["mat-raised-button","","color","accent",3,"disabled","click"],["mat-raised-button","","color","warn",3,"disabled","click"],["class","export-status",4,"ngIf"],["class","loading-container",4,"ngIf"],["class","preview-card",4,"ngIf"],[3,"label"],[3,"value"],["formControlName","reportMode"],[1,"date-group"],[1,"group-label"],["formControlName","dateMode"],[3,"value","disabled",4,"ngFor","ngForOf"],[3,"value","disabled"],["matInput","","formControlName","travelDateStart",3,"matDatepicker"],["matSuffix","",3,"for"],["travelStartPicker",""],["matInput","","formControlName","travelDateEnd",3,"matDatepicker"],["travelEndPicker",""],["matInput","","formControlName","saleDateStart",3,"matDatepicker"],["saleStartPicker",""],["matInput","","formControlName","saleDateEnd",3,"matDatepicker"],["saleEndPicker",""],["matInput","","type","text","formControlName","customerSearch","autocomplete","off",3,"matAutocomplete"],["mat-icon-button","","matSuffix","","type","button","aria-label","Limpar cliente",3,"click",4,"ngIf"],[3,"displayWith","optionSelected"],["customerAutoComplete","matAutocomplete"],["disabled","",4,"ngIf"],["mat-icon-button","","matSuffix","","type","button","aria-label","Limpar cliente",3,"click"],["disabled",""],[1,"customer-option"],[1,"customer-option__name"],[1,"customer-option__doc"],["formControlName","productType"],["value",""],["matInput","","type","text","formControlName","sellerSearch","autocomplete","off",3,"matAutocomplete"],["mat-icon-button","","matSuffix","","type","button","aria-label","Limpar vendedor",3,"click",4,"ngIf"],["sellerAutoComplete","matAutocomplete"],["mat-icon-button","","matSuffix","","type","button","aria-label","Limpar vendedor",3,"click"],[1,"seller-option"],[1,"seller-option__name"],[1,"seller-option__email"],[1,"advanced-panel",3,"expanded","expandedChange"],["matInput","","type","text","formControlName","passengerName","autocomplete","off"],["matInput","","type","text","formControlName","serviceOrderCode","autocomplete","off"],["formControlName","statusFilter"],["value","pending"],["value","completed"],["value","paid"],["value","received"],["value","delayed"],["value","billed"],[1,"summary-line"],[1,"export-status"],[1,"loading-container"],[1,"preview-card"],[1,"table-container"],["mat-table","",1,"preview-table",3,"dataSource"],[3,"matColumnDef",4,"ngFor","ngForOf"],["mat-header-row","",4,"matHeaderRowDef"],["mat-row","",4,"matRowDef","matRowDefColumns"],[3,"matColumnDef"],["mat-header-cell","",4,"matHeaderCellDef"],["mat-cell","",4,"matCellDef"],["mat-header-cell",""],["mat-cell",""],["mat-header-row",""],["mat-row",""]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"h1"),e._uU(3,"Relatorios exportaveis"),e.qZA(),e.TgZ(4,"p",2),e._uU(5,"Comece escolhendo o relatorio e o periodo. Depois refine com filtros."),e.qZA()(),e.TgZ(6,"mat-card",3)(7,"mat-tab-group",4),e.NdJ("selectedIndexChange",function(n){return o.onCategoryChange(n)}),e.YNc(8,oe,1,1,"mat-tab",5),e.qZA(),e.TgZ(9,"div",6),e._uU(10),e.qZA()(),e.TgZ(11,"mat-card",7)(12,"mat-card-header")(13,"mat-card-title"),e._uU(14,"Configuracao do relatorio"),e.qZA()(),e.TgZ(15,"mat-card-content")(16,"form",8)(17,"div",9)(18,"mat-form-field",10)(19,"mat-label"),e._uU(20,"Relatorio"),e.qZA(),e.TgZ(21,"mat-select",11),e.YNc(22,ae,2,2,"mat-option",12),e.qZA(),e.YNc(23,re,2,1,"mat-hint",13),e.qZA(),e.YNc(24,se,5,1,"mat-form-field",14),e.qZA(),e.YNc(25,pe,12,4,"div",15),e.YNc(26,xe,4,3,"div",16),e.YNc(27,Pe,10,4,"mat-expansion-panel",17),e.YNc(28,Se,2,1,"div",18),e.qZA()(),e.TgZ(29,"mat-card-actions",19)(30,"button",20),e.NdJ("click",function(){return o.onPreview()}),e.TgZ(31,"mat-icon"),e._uU(32,"visibility"),e.qZA(),e._uU(33," Visualizar "),e.qZA(),e.TgZ(34,"button",21),e.NdJ("click",function(){return o.onExport("csv")}),e.TgZ(35,"mat-icon"),e._uU(36,"download"),e.qZA(),e._uU(37," Exportar CSV "),e.qZA(),e.TgZ(38,"button",22),e.NdJ("click",function(){return o.onExport("pdf")}),e.TgZ(39,"mat-icon"),e._uU(40,"picture_as_pdf"),e.qZA(),e._uU(41," Exportar PDF "),e.qZA(),e.YNc(42,Oe,2,1,"span",23),e.qZA()(),e.YNc(43,Re,4,0,"div",24),e.YNc(44,Ne,12,7,"mat-card",25),e.qZA()),2&t&&(e.xp6(7),e.Q6J("selectedIndex",o.selectedCategoryIndex),e.xp6(1),e.Q6J("ngForOf",o.categories),e.xp6(2),e.hij(" ",o.selectedCategoryDescription," "),e.xp6(6),e.Q6J("formGroup",o.reportForm),e.xp6(6),e.Q6J("ngForOf",o.filteredReports),e.xp6(1),e.Q6J("ngIf",o.selectedReport),e.xp6(1),e.Q6J("ngIf",o.supportsReportMode),e.xp6(1),e.Q6J("ngIf",o.selectedReport),e.xp6(1),e.Q6J("ngIf",o.selectedReport),e.xp6(1),e.Q6J("ngIf",o.selectedReport),e.xp6(1),e.Q6J("ngIf",o.selectedReport),e.xp6(2),e.Q6J("disabled",o.isLoading||!o.selectedReport),e.xp6(4),e.Q6J("disabled",o.isLoading||!o.selectedReport),e.xp6(4),e.Q6J("disabled",o.isLoading||!o.selectedReport),e.xp6(4),e.Q6J("ngIf",o.exportStatusMessage),e.xp6(1),e.Q6J("ngIf",o.isLoading),e.xp6(1),e.Q6J("ngIf",o.previewData.length>0&&!o.isLoading))},dependencies:[y.sg,y.O5,u._Y,u.Fj,u.JJ,u.JL,u.sg,u.u,_.a8,_.dk,_.dn,_.n5,_.$j,_.hq,C.KE,C.bx,C.hX,C.R9,F.Nt,k.gD,I.ey,Z.lW,A.Hw,x.Mq,x.hl,x.nW,m.BZ,m.fO,m.as,m.w1,m.Dz,m.nj,m.ge,m.ev,m.XQ,m.Gk,N.Ou,M.SP,M.uX,D.XC,D.ZL,b.ib,b.yz,b.yK,b.u4,y.Ov],styles:[".reports-dashboard[_ngcontent-%COMP%]{padding:24px;max-width:1280px;margin:0 auto}.reports-dashboard[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]{margin-bottom:24px}.reports-dashboard[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:2rem;font-weight:600;margin-bottom:8px;color:#333}.reports-dashboard[_ngcontent-%COMP%]   .page-header[_ngcontent-%COMP%]   .page-description[_ngcontent-%COMP%]{color:#666;font-size:1rem;margin:0}.reports-dashboard[_ngcontent-%COMP%]   .category-card[_ngcontent-%COMP%]{margin-bottom:16px}.reports-dashboard[_ngcontent-%COMP%]   .category-card[_ngcontent-%COMP%]   .category-description[_ngcontent-%COMP%]{padding:12px 16px 16px;color:#555;font-size:.95rem}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]{margin-bottom:24px}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-form[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(220px,1fr));gap:16px}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-form[_ngcontent-%COMP%]   .summary-line[_ngcontent-%COMP%]{padding:10px 12px;border:1px solid #e6e6e6;background:#fcfcfc;border-radius:8px;color:#444;font-size:.95rem;line-height:1.3}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-form[_ngcontent-%COMP%]   .date-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-form[_ngcontent-%COMP%]   .date-group[_ngcontent-%COMP%]   .group-label[_ngcontent-%COMP%]{font-weight:600;color:#444}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-form[_ngcontent-%COMP%]   .advanced-panel[_ngcontent-%COMP%]{background:#fafafa;margin-top:4px}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-form[_ngcontent-%COMP%]   .advanced-panel[_ngcontent-%COMP%]   .filter-row[_ngcontent-%COMP%]{padding-top:8px}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-form[_ngcontent-%COMP%]   .customer-option[_ngcontent-%COMP%]{display:flex;flex-direction:column;line-height:1.2;padding:2px 0}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-form[_ngcontent-%COMP%]   .customer-option__name[_ngcontent-%COMP%]{font-weight:600;color:#333}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-form[_ngcontent-%COMP%]   .customer-option__doc[_ngcontent-%COMP%]{font-size:.85rem;color:#666}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-form[_ngcontent-%COMP%]   .seller-option[_ngcontent-%COMP%]{display:flex;flex-direction:column;line-height:1.2;padding:2px 0}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-form[_ngcontent-%COMP%]   .seller-option__name[_ngcontent-%COMP%]{font-weight:600;color:#333}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .filter-form[_ngcontent-%COMP%]   .seller-option__email[_ngcontent-%COMP%]{font-size:.85rem;color:#666}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:12px;align-items:center;padding:16px 24px}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{min-width:140px}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .export-status[_ngcontent-%COMP%]{font-size:.95rem;color:#555;margin-left:auto}.reports-dashboard[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:48px;text-align:center}.reports-dashboard[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   mat-spinner[_ngcontent-%COMP%]{margin-bottom:16px}.reports-dashboard[_ngcontent-%COMP%]   .loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#666;font-size:1rem}.reports-dashboard[_ngcontent-%COMP%]   .preview-card[_ngcontent-%COMP%]   .table-container[_ngcontent-%COMP%]{max-height:520px;overflow:auto;border:1px solid #e0e0e0;border-radius:4px}.reports-dashboard[_ngcontent-%COMP%]   .preview-card[_ngcontent-%COMP%]   .preview-table[_ngcontent-%COMP%]{width:100%}.reports-dashboard[_ngcontent-%COMP%]   .preview-card[_ngcontent-%COMP%]   .preview-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .reports-dashboard[_ngcontent-%COMP%]   .preview-card[_ngcontent-%COMP%]   .preview-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 16px;text-align:left;border-bottom:1px solid #e0e0e0}.reports-dashboard[_ngcontent-%COMP%]   .preview-card[_ngcontent-%COMP%]   .preview-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background-color:#f5f5f5;font-weight:600;color:#333;position:sticky;top:0;z-index:1}.reports-dashboard[_ngcontent-%COMP%]   .preview-card[_ngcontent-%COMP%]   .preview-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{color:#555}.reports-dashboard[_ngcontent-%COMP%]   .preview-card[_ngcontent-%COMP%]   .preview-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}@media (max-width: 768px){.reports-dashboard[_ngcontent-%COMP%]{padding:16px}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]{flex-direction:column;align-items:stretch}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}.reports-dashboard[_ngcontent-%COMP%]   .filter-card[_ngcontent-%COMP%]   .actions[_ngcontent-%COMP%]   .export-status[_ngcontent-%COMP%]{margin-left:0}}"]}),r})()},{path:"**",redirectTo:""}];let Ee=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[E.Bz.forChild(we),E.Bz]}),r})(),Ue=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=e.oAB({type:r}),r.\u0275inj=e.cJS({imports:[y.ez,u.UX,Ee,_.QW,C.lN,F.c,k.LD,Z.ot,A.Ps,x.FA,I.XK,m.p0,N.Cq,w.ZX,M.Nh,D.Bb,b.To]}),r})()}}]);